# AI Photo Studio — Telegram-бот для персональных AI-фотосессий

Java, Core, Spring Boot, Spring Data JPA, PostgreSQL, Telegram Bot API, Docker, Maven, Reactor

## О проекте

Коммерческий Telegram-бот для создания персональных AI-фотосессий.  
Пользователь загружает свои фотографии, система обучает персональную модель и генерирует реалистичные изображения в различных стилях или по текстовому описанию.

Проект реализован как полноценный продукт: с платежами, лимитами генераций, воронкой продаж, отложенными предложениями и повторными покупками.

## Архитектура

Проект построен по принципам **Clean Architecture** и **Hexagonal Architecture (Ports & Adapters)**  
и разделён на независимые модули.

## Core (бизнес-логика)

Модуль **core** — сердце проекта.

- Не зависит от Telegram, Spring и базы данных
- Содержит всю бизнес-логику:
  - заказы
  - лимиты генераций
  - правила покупок
  - статусы обучения модели
  - добивки и повторные покупки
- Использует только Java и собственные интерфейсы (ports)

Такой подход позволяет:
- легко тестировать бизнес-логику
- менять Telegram на другой канал (Web, Mobile)
- менять БД без переписывания core-кода

## Telegram Bot

Модуль **adapter-telegram** реализует пользовательский интерфейс и сценарии:

- Webhook-обработчик обновлений
- Inline-кнопки и callback-логика
- Telegram Payments:
  - invoices
  - pre_checkout
  - successful_payment
- Follow-up сценарии:
  - через 30 минут после оффера
  - через 24 часа с вопросом «что остановило»
- Разные UX-ветки в зависимости от действий пользователя

## Payments & Offers

Реализована полноценная коммерческая логика:

- Основная покупка:
  - персональная модель
  - 60 сгенерированных фото
- Follow-up пакеты:
  - через 30 минут — 1 модель + 18 фото
  - через 24 часа — 1 модель + 18 фото
- Дополнительные пакеты фотографий
- Идемпотентная обработка платежей
- Покупка открывает доступ к следующему этапу:
  - загрузка фото
  - обучение модели
  - генерация изображений

## Scheduler

Отдельный scheduler-сервис:

- проверяет заказы раз в минуту
- отправляет follow-up предложения только если покупка не совершена
- никогда не отправляет дубли
- вся логика основана на timestamps в базе данных

## Tech Stack

### Backend
- Java 21
- Spring Boot
- Spring Scheduling
- Spring Data JPA
- Hibernate
- PostgreSQL
- Reactor (асинхронная обработка)

### Architecture
- Clean Architecture
- Hexagonal Architecture (Ports & Adapters)
- Multi-module Maven project
- Dependency Inversion Principle

### Telegram
- Telegram Bot API
- Webhooks
- Inline keyboards
- Payments
